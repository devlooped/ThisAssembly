<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <IsPackable>false</IsPackable>
    <TargetFramework>net8.0</TargetFramework>
    <Multiline>
      A Description
      with a newline and
      * Some "things" with quotes
      // Some comments too.
    </Multiline>
    <Description>A Description
      with a newline and
      * Some "things" with quotes
      // Some comments too.</Description>
    <TargetFramework Condition="'$(BuildingInsideVisualStudio)' == 'true'">net472</TargetFramework>
    <RootNamespace>ThisAssemblyTests</RootNamespace>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
    <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
  </PropertyGroup>

  <Import Project="..\*\*.props" />

  <ItemGroup>
    <Compile Remove="..\*.cs" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.csproj" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
    <ProjectReference Include="..\ThisAssembly.Constants\ThisAssembly.Constants.csproj" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
    <ProjectReference Include="..\ThisAssembly.Metadata\ThisAssembly.Metadata.csproj" ReferenceOutputAssembly="false" />
    <ProjectReference Include="..\ThisAssembly.Project\ThisAssembly.Project.csproj" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
    <ProjectReference Include="..\ThisAssembly.Resources\ThisAssembly.Resources.csproj" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
    <ProjectReference Include="..\ThisAssembly.Strings\ThisAssembly.Strings.csproj" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.SourceLink.GitHub" Version="8.0.0" PrivateAssets="all" />
    <PackageReference Include="PolySharp" Version="1.14.1" PrivateAssets="All" />
    <PackageReference Include="Microsoft.CodeAnalysis.CSharp" Version="4.0.1" Pack="false" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="17.10.0" />
    <PackageReference Include="xunit" Version="2.8.1" />
    <PackageReference Include="xunit.runner.visualstudio" Version="2.8.1" />

    <PackageReference Include="Humanizer.Core" Version="2.14.1" PrivateAssets="all" GeneratePathProperty="true" />
    <PackageReference Include="System.IdentityModel.Tokens.Jwt" Version="7.6.0" PrivateAssets="all" GeneratePathProperty="true" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Update="Resources.es.resx" Generator="" CopyToOutputDirectory="PreserveNewest" />
    <EmbeddedResource Update="Resources.resx" Generator="" CopyToOutputDirectory="PreserveNewest" />
    <EmbeddedResource Include="Content/Styles/Custom.css" Kind="Text" Comment="Secondary CSS" />
    <EmbeddedResource Include="Content/Styles/Main.css" Comment="Primary CSS" />
    <EmbeddedResource Include="Content/Docs/*" />
    <EmbeddedResource Include="Content/Swagger/*" />
    <EmbeddedResource Include="webhook-data.json" Kind="text" />
  </ItemGroup>

  <PropertyGroup>
    <Foo>Bar</Foo>
  </PropertyGroup>

  <ItemGroup>
    <ProjectProperty Include="Foo" />
    <ProjectProperty Include="Foo" />
    <ProjectProperty Include="Description" />
    <!-- Multiline values that go through .editorconfig will get truncated, unfortunately -->
    <ProjectProperty Include="Multiline" />
    <Constant Include="Foo.Raw" Value="$(Multiline)" Comment="$(Multiline)" />
    <Constant Include="Foo.Bar" Value="Baz" Comment="Yay!" />
    <Constant Include="Foo.Hello" Value="World" Comment="Comments make everything better 😍" />
    <Constant Include="WithSemiColon" Value="A;B;C" />
    <FileConstant Include="@(None)" />
    <FileConstant Update="@(FileConstant -&gt; WithMetadataValue('Filename', 'Readme'))">
      <Link>Included/%(Filename)%(Extension)</Link>
    </FileConstant>
    <AssemblyMetadata Include="Foo" Value="Bar" />
    <AssemblyMetadata Include="Raw" Value="$(Multiline)" />
    <AssemblyMetadata Include="Root.Foo.Bar" Value="Baz" Comment="Comment" />
  </ItemGroup>

  <ItemGroup>
    <Compile Include="..\ThisAssembly.Strings\Model.cs" Link="Model.cs" />
  </ItemGroup>

  <Target Name="AddSponsorLinkAnalyzerDependencies" BeforeTargets="CoreCompile" DependsOnTargets="ResolveLockFileCopyLocalFiles">
    <ItemGroup>
      <ReferenceCopyLocalAssemblies Include="@(ReferenceCopyLocalPaths)" Condition="'%(Extension)' == '.dll' 
        And !$([MSBuild]::ValueOrDefault('%(FileName)', '').EndsWith('.resources', StringComparison.OrdinalIgnoreCase))
        And !$([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('ThisAssembly', StringComparison.OrdinalIgnoreCase))" />
      <Analyzer Include="@(ReferenceCopyLocalAssemblies)" Condition="
        !$([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('Microsoft.CodeAnalysis', StringComparison.OrdinalIgnoreCase)) And
        !$([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('Microsoft.CSharp', StringComparison.OrdinalIgnoreCase)) And
        !$([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('System.', StringComparison.OrdinalIgnoreCase))"
      />
      <!-- Brings in System/Microsoft.IdentityModel, System.Text.Encodings.Web, System.Text.Json  -->
      <Analyzer Include="@(ReferenceCopyLocalAssemblies)" Condition="
        $([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('System.IdentityModel', StringComparison.OrdinalIgnoreCase)) Or
        $([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('Microsoft.IdentityModel', StringComparison.OrdinalIgnoreCase)) Or
        $([MSBuild]::ValueOrDefault('%(FileName)', '').StartsWith('System.Text', StringComparison.OrdinalIgnoreCase))"
      />
    </ItemGroup>
  </Target>

  <Target Name="RenderVersion" AfterTargets="Build">
    <GetVersion>
      <Output TaskParameter="Version" PropertyName="Version2" />
    </GetVersion>
    <Message importance="high" Text="Version: $(Version2)" />
  </Target>

  <Import Project="..\*\ThisAssembly*.targets" />

</Project>
