<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <IsPackable>false</IsPackable>
    <TargetFramework>net6.0</TargetFramework>
    <TargetFramework Condition="'$(BuildingInsideVisualStudio)' == 'true'">net472</TargetFramework>
    <RootNamespace>ThisAssemblyTests</RootNamespace>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
    <GetTargetPathDependsOn>$(GetTargetPathDependsOn);GetDependencyTargetPaths</GetTargetPathDependsOn>
    <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
  </PropertyGroup>

  <!--
    Import .props files from source generator projects.
    This happens automatically for package references that have <PackageName>.props in the build/ folder;
    for project references we must do it manually.
  -->
  <Import Project="..\SourceGenerators\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.props"
          Condition="Exists('..\SourceGenerators\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.props')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Constants\ThisAssembly.Constants.props"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Constants\ThisAssembly.Constants.props')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Metadata\ThisAssembly.Metadata.props"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Metadata\ThisAssembly.Metadata.props')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Project\ThisAssembly.Project.props"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Project\ThisAssembly.Project.props')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Strings\ThisAssembly.Strings.props"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Strings\ThisAssembly.Strings.props')" />

  <ItemGroup>
    <ProjectReference Include="..\SourceGenerators\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.csproj" />
    <ProjectReference Include="..\SourceGenerators\ThisAssembly.Constants\ThisAssembly.Constants.csproj" />
    <ProjectReference Include="..\SourceGenerators\ThisAssembly.Metadata\ThisAssembly.Metadata.csproj" />
    <ProjectReference Include="..\SourceGenerators\ThisAssembly.Project\ThisAssembly.Project.csproj" />
    <ProjectReference Include="..\SourceGenerators\ThisAssembly.Strings\ThisAssembly.Strings.csproj" />
    <ProjectReference Update="@(ProjectReference)" OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.CodeAnalysis.CSharp" Pack="false" />
    <PackageReference Include="Microsoft.NET.Test.Sdk" />
    <PackageReference Include="xunit" />
    <PackageReference Include="xunit.runner.visualstudio" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Update="Resources.resx">
      <Generator></Generator>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </EmbeddedResource>
  </ItemGroup>

  <PropertyGroup>
    <Foo>Bar</Foo>
  </PropertyGroup>

  <ItemGroup>
    <ProjectProperty Include="Foo" />
    <Constant Include="Foo.Bar" Value="Baz" Comment="Yay!" />
    <Constant Include="Foo.Hello" Value="World" Comment="Comments make everything better 😍" />
    <FileConstant Include="@(None)" />
    <FileConstant Update="@(FileConstant -&gt; WithMetadataValue('Filename', 'Readme'))">
      <Link>Included/%(Filename)%(Extension)</Link>
    </FileConstant>
    <AssemblyMetadata Include="Foo" Value="Bar" />
  </ItemGroup>
  
  <Target Name="GetDependencyTargetPaths" Returns="@(TargetPathWithTargetPlatformMoniker)">
    <ItemGroup>
      <!--<TargetPathWithTargetPlatformMoniker Include="$(PKGCsvTextFieldParser)\lib\netstandard2.0\CsvTextFieldParser.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PKGHandlebars_Net)\lib\netstandard2.0\Handlebars.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PKGNewtonsoft_Json)\lib\netstandard2.0\Newtonsoft.Json.dll" IncludeRuntimeDependency="false" />-->
    </ItemGroup>
  </Target>

  <!--
    Import .targets files from source generator projects.
    This happens automatically for package references that have <PackageName>.props in the build/ folder;
    for project references we must do it manually.
  -->
  <Import Project="..\SourceGenerators\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.targets"
          Condition="Exists('..\SourceGenerators\ThisAssembly.AssemblyInfo\ThisAssembly.AssemblyInfo.targets')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Constants\ThisAssembly.Constants.targets"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Constants\ThisAssembly.Constants.targets')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Metadata\ThisAssembly.Metadata.targets"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Metadata\ThisAssembly.Metadata.targets')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Project\ThisAssembly.Project.targets"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Project\ThisAssembly.Project.targets')" />
  <Import Project="..\SourceGenerators\ThisAssembly.Strings\ThisAssembly.Strings.targets"
          Condition="Exists('..\SourceGenerators\ThisAssembly.Strings\ThisAssembly.Strings.targets')" />

</Project>
